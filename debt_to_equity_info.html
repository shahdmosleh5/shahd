<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="website icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/2657/2657051.png">
    <title>Debt to Equity Ratio Analysis</title>
    <link rel="stylesheet" href="css_analysis.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Adding custom CSS for positive and negative analysis */
        .positive-analysis {
            color: rgb(55, 237, 55);
            font-weight: bold;
        }

        .negative-analysis {
            color: red;
            font-weight: bold;
        }

        .neutral-analysis {
            color: orange;
        }

        /* Styling the manager's comment section */
        .manager-comment {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-left: 4px solid #00c3ff;
            color: #fff;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="excel.html" class="back-btn">&larr; Back</a>
        <h1>Debt to Equity Ratio Analysis</h1>
        <div class="canvas-container">
            <canvas id="debtToEquityChart"></canvas>
        </div>
        <div class="analysis-section">
            <h2>Deep Analysis</h2>
            <p id="debtToEquity-analysis">Analyzing data...</p>
        </div>

        <!-- Manager's Comment Section -->
        <div class="manager-comment" id="manager-comment">
            <!-- The manager's comment will be inserted here -->
        </div>

        <div class="footer">
            <p>Need help? <a href="Financial Statements Analysis Made Easy.html">Contact Support</a></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Default values for Debt to Equity Ratio
            const debtToEquity2021 = 30.51;  // Example value for 2021
            const debtToEquity2022 = 40.77;  // Provided value for 2022
            // Retrieve Debt to Equity Ratio value for 2023 from localStorage (fallback to 0 if not set)
            const debtToEquity2023 = parseFloat(localStorage.getItem('debtToEquity2023')) || 0;

            // Data for the chart
            const labels = ['2021', '2022', '2023'];
            const data = {
                labels: labels,
                datasets: [{
                    label: 'Debt to Equity Ratio',
                    data: [debtToEquity2021, debtToEquity2022, debtToEquity2023],
                    backgroundColor: 'rgba(0, 195, 255, 0.6)',
                    borderColor: '#00c3ff',
                    borderWidth: 2,
                    hoverBackgroundColor: 'rgba(0, 195, 255, 0.8)'
                }]
            };

            // Chart configuration
            const config = {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#fff',
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.raw;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255, 255, 255, 0.2)' }
                        },
                        y: {
                            ticks: { color: '#fff', callback: (value) => value },
                            grid: { color: 'rgba(255, 255, 255, 0.2)' }
                        }
                    }
                }
            };

            // Render the chart
            const ctx = document.getElementById('debtToEquityChart').getContext('2d');
            new Chart(ctx, config);

            // Analysis section
            let analysis = '';
            let analysisClass = '';

            // Analysis between 2022 and 2023
            if (debtToEquity2023 < debtToEquity2022) {
                const decrease = ((debtToEquity2022 - debtToEquity2023) / debtToEquity2022) * 100;
                analysis += `In 2023, the Debt to Equity Ratio decreased compared to 2022, with a drop of ${decrease.toFixed(2)}%. `;
                analysisClass = 'positive-analysis';
            } else if (debtToEquity2023 > debtToEquity2022) {
                const increase = ((debtToEquity2023 - debtToEquity2022) / debtToEquity2022) * 100;
                analysis += `In 2023, the Debt to Equity Ratio increased compared to 2022, with an increase of ${increase.toFixed(2)}%. `;
                analysisClass = 'negative-analysis';
            } else {
                analysis += `In 2023, the Debt to Equity Ratio remained the same as 2022. `;
                analysisClass = 'neutral-analysis';
            }

            // Analysis between 2021 and 2022
            if (debtToEquity2022 < debtToEquity2021) {
                const decrease = ((debtToEquity2021 - debtToEquity2022) / debtToEquity2021) * 100;
                analysis += `The trend from 2021 to 2022 showed a decline of ${decrease.toFixed(2)}%.`;
            } else if (debtToEquity2022 > debtToEquity2021) {
                const increase = ((debtToEquity2022 - debtToEquity2021) / debtToEquity2021) * 100;
                analysis += `The trend from 2021 to 2022 was positive, with a decrease of ${increase.toFixed(2)}%.`;
            } else {
                analysis += `The Debt to Equity Ratio remained the same from 2021 to 2022.`;
            }

            // Update the analysis section with the correct class for styling
            const analysisElement = document.getElementById('debtToEquity-analysis');
            analysisElement.textContent = analysis;
            analysisElement.className = analysisClass;

            // Manager's Comment section
            let managerComment = '';
            if (debtToEquity2023 < 1) {
                managerComment = `The company has reduced its Debt to Equity Ratio in 2023, indicating stronger financial stability and reduced reliance on external financing. This is a positive sign for future growth.`;
            } else if (debtToEquity2023 > debtToEquity2022) {
                managerComment = `An increase in the Debt to Equity Ratio in 2023 indicates higher leverage and a higher dependency on external financing. This may be a potential risk to monitor closely.`;
            } else {
                managerComment = `The Debt to Equity Ratio remained stable, which indicates a balanced approach between debt and equity. However, continued monitoring of debt levels is advised.`;
            }

            // Insert manager comment
            document.getElementById('manager-comment').textContent = managerComment;
        });
    </script>
</body>
</html>
